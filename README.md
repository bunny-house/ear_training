# Ear Training Game

一个纯前端的初学者练耳闯关游戏，旨在帮助用户通过听音辨音提高音乐听觉能力。

## 功能需求 (Requirements)

1.  **技术栈**:
    *   使用 Vue 3 + Vite 构建。
    *   纯前端实现，无后端依赖。

2.  **游戏关卡设计**:
    *   **Level 1 (C Major / 白键)**:
        *   **流程**: 播放参考音 C4 (Do)，随后播放一个基于此调式的随机音符 (Re, Mi, Fa, Sol, La, Si)。
        *   **选项**: 提供 1(Do) 到 7(Si) 共7个选项供用户选择。
        *   **规则**: 每轮10题，每题10分，满分100分。
    *   **Level 2 (Chromatic / 半音阶)**:
        *   **范围**: 在 Level 1 的基础上，增加该八度内的所有非白键（黑键/半音）内容。
        *   **选项**: 提供包含升/降号的完整12个音符选项。
    *   **Level 3 (Movable Do / 移动调)**:
        *   **机制**: 引入“首调”概念。系统不再固定使用 C4 作为 Do。
        *   **流程**: 每一轮随机选择一个音高作为参考音 "Do"（例如 F4, G3 等），然后播放目标音。
        *   **目标**: 用户需要忽略绝对音高，根据参考音建立的调性中心，听辨出目标音的相对唱名（Do, Re, Mi...）。
        *   **选项**: 同 Level 2，使用完整的半音阶选项。

3.  **音频系统**:
    *   使用 Web Audio API 生成音频。
    *   音色需模拟钢琴音色（使用波形合成，不依赖静态资源文件）。

## 约束与修正记录 (Constraints & Fixes)

1.  **UI/UX 设计**:
    *   **深色模式 (Dark Mode)**: 界面必须完整支持浏览器/系统的深色模式切换。
    *   **对比度要求**: 即使在深色模式下，白色琴键（White Keys）等浅色背景元素上的文字必须保持深色（如黑色），以确保可读性。页面其他常规按钮需根据模式反转颜色。
    *   **交互体验**: 界面需美观，并提供合理的交互反馈（如听音状态、对错反馈）。

2.  **浏览器策略兼容性**:
    *   **AudioContext 初始化**: 由于浏览器的自动播放策略（Autoplay Policy），`AudioContext` 的初始化或 `resume()` 必须在**用户产生交互（如点击按钮）的同步调用栈**中立即执行。不能仅将其放在异步回调（如 `setTimeout`）中，否则会导致首个音符无法播放。

## 未来规划 (Roadmap)

以下是进阶关卡的规划方向，旨在引导学习这从单音听辨过渡到更复杂的音乐元素听辨：

*   **Level 4 - 音程辨认 (Intervals)**
    *   **痛点**: 从“这个音叫什么”进阶到“这两个音离多远”。
    *   **玩法**: 取消参考音 Do，直接播放两个音。用户需判断其音程关系（如大三度、纯五度）。

*   **Level 5 - 和弦色彩/性质 (Chord Quality)**
    *   **痛点**: 能够分辨和声的情感色彩（开心、悲伤、紧张）。
    *   **玩法**: 同时播放三个音（和弦）。用户需判断和弦性质（大三和弦、小三和弦、减三和弦等）。

*   **Level 6 - 旋律听写 (Melodic Dictation)**
    *   **痛点**: 训练短时音乐记忆力。
    *   **玩法**: 播放由3-5个音组成的短旋律，用户需按顺序正确写出所有音符。

*   **Level 7 - 节奏听辨 (Rhythm)**
    *   **痛点**: 训练对时间维度的感知。
    *   **玩法**: 使用打击乐音色播放节奏型，用户需选择对应的节奏谱或描述（如切分音、三连音）。
